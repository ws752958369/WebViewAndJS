webpackJsonp([24],{166:function(t,e,n){function i(t){n(879)}var o=n(1)(n(834),n(974),i,"data-v-1f5d0e0c",null);t.exports=o.exports},834:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(11),a=i(o),s=n(55),r=n(33),c=n(143),l=i(c),f=n(66),d=i(f),p=n(25);e.default={name:"write-off",mixins:[s.methodsMixin,s.filtersMixin],props:{loanList:{type:[Array]},selectedLoanList:{type:[Array]},isForcible:{type:Boolean,default:!1},applicantOID:{type:String},venMasterId:{type:String},baseCurrencyCode:{type:String},paymentAmount:{type:Number},companyOID:{type:String}},data:function(){return{isShowLoading:!1,localLoanList:[],localSelectedLoanList:[],localSelectedLoanOIDList:{},page:0,size:100,totalPage:10,status:[1005,1006].join(",")}},computed:(0,a.default)({},(0,p.mapGetters)(["getProfile"]),{selectedAmount:function(){var t=this.localSelectedLoanList,e=0;return t.reduce(function(t,n,i){return e+=n.stayWriteOffAmount},e),e},canRefunAmount:function(){var t=this.selectedAmount,e=this.paymentAmount;return t>e?e:t},restAmount:function(){return this.paymentAmount-this.canRefunAmount}}),methods:{localInit:function(){var t=this;this.resetData(),this.isForcible&&this.selectedLoanList&&this.selectedLoanList.length>0?(this.localLoanList=this.loanList,this.selectedLoanList.forEach(function(e){var n=(e.loanBillOID,t.localSelectedLoanList.push(t.selectedLoanList));t.localSelectedLoanOIDList[e.loanBillOID]=n})):this.getLoanApplicationToWriteOff()},resetData:function(){this.localLoanList=[],this.localSelectedLoanList=[],this.localSelectedLoanOIDList={}},getLoanApplicationToWriteOff:function(){var t=this,e=this.page,n=this.size,i=this.status,o=this.applicantOID,a=this.venMasterId,s=this.baseCurrencyCode,c=this.companyOID;this.isShowLoading=!0,(0,r.getLoanApplicationToWriteOff)({page:e,size:n,status:i,applicantOID:o,venMasterId:a,currencyCode:s,companyOID:c}).then(function(e){if(t.isShowLoading=!1,e&&e.data){var n=e.data,i=n.length;e.headers;n&&i>0?(t.isForcible?t.localLoanList=n.filter(function(e){if(e.stayWriteOffAmount)return e.stayWriteOffAmount>0&&e.currencyCode===t.baseCurrencyCode&&!e.referenceApplicationOID}):t.localLoanList=n.filter(function(e){if(e.stayWriteOffAmount)return e.stayWriteOffAmount>0&&e.currencyCode===t.baseCurrencyCode}),t.localLoanList.length||t.onImmediateSubmited()):t.onImmediateSubmited()}}).catch(function(e){t.isShowLoading=!1})},nextPage:function(){this.page+=1,this.getLoanApplicationToWriteOff()},refresh:function(){this.resetData(),this.page=0,this.getLoanApplicationToWriteOff()},onSelected:function(t){var e=t.loanBillOID,n=void 0;void 0===this.localSelectedLoanOIDList[e]?(this.localSelectedLoanList=[],this.localSelectedLoanOIDList={},n=this.localSelectedLoanList.push(t),this.$set(this.localSelectedLoanOIDList,e,n)):(this.localSelectedLoanList=[],this.localSelectedLoanOIDList={})},onImmediateSubmited:function(){this.$emit("immediate-submited")},onRefundSubmited:function(){var t=this.localLoanList,e=this.localSelectedLoanList;if(t&&0===t.length)this.$emit("immediate-submited");else if(0===e.length)this.showToast("请选择需要核销的借款单");else{var n=e[0];if(this.getProfile["All.ER.GreaterThanLoan"]&&this.restAmount<0)return this.showToast("报销单金额不能小于借款单金额");this.$emit("refund-submited",n.loanBillOID)}}},mounted:function(){this.localInit()},components:{loading:d.default,EmptyContent:l.default}}},845:function(t,e,n){e=t.exports=n(468)(),e.push([t.i,"\n.write-off-wrapper[data-v-1f5d0e0c] {\n  line-height: 1;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: #ebedef;\n  overflow: auto;\n  scroll-behavior: smooth;\n  z-index: 1;\n}\n.write-off-wrapper .sub-title[data-v-1f5d0e0c] {\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    width: 100%;\n    -webkit-box-sizing: border-box;\n       -moz-box-sizing: border-box;\n            box-sizing: border-box;\n    background: #fff;\n    font-size: 0.12rem;\n    height: 0.32rem;\n    padding: 0.1rem 0.15rem;\n    -webkit-box-shadow: inset 0 1px 0 0 #D7DCE6;\n       -moz-box-shadow: inset 0 1px 0 0 #D7DCE6;\n            box-shadow: inset 0 1px 0 0 #D7DCE6;\n}\n.write-off-wrapper .sub-title .text[data-v-1f5d0e0c] {\n      color: #505564;\n}\n.write-off-wrapper .sub-title .submit-btn[data-v-1f5d0e0c] {\n      color: #1E78C8;\n}\n.write-off-wrapper .content[data-v-1f5d0e0c] {\n    padding-bottom: 0.74rem;\n}\n.write-off-wrapper .content.has-subtitle[data-v-1f5d0e0c] {\n      margin-top: 0.42rem;\n}\n.write-off-wrapper .content .list[data-v-1f5d0e0c] {\n      scroll-behavior: smooth;\n}\n.write-off-wrapper .content .list .item[data-v-1f5d0e0c] {\n        display: -webkit-box;\n        display: -webkit-flex;\n        display: -moz-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-pack: center;\n        -webkit-justify-content: center;\n           -moz-box-pack: center;\n            -ms-flex-pack: center;\n                justify-content: center;\n        -webkit-box-align: center;\n        -webkit-align-items: center;\n           -moz-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        height: 0.59rem;\n        padding: 0.14rem 0.15rem;\n        -webkit-box-sizing: border-box;\n           -moz-box-sizing: border-box;\n                box-sizing: border-box;\n        background: #fff;\n}\n.write-off-wrapper .content .list .item.active[data-v-1f5d0e0c] {\n          background: #F1F5F9;\n}\n.write-off-wrapper .content .list .item .left[data-v-1f5d0e0c] {\n          width: 2.11rem;\n}\n.write-off-wrapper .content .list .item .left .date[data-v-1f5d0e0c] {\n            font-size: 0.12rem;\n            color: #8C96B4;\n}\n.write-off-wrapper .content .list .item .left .title[data-v-1f5d0e0c] {\n            height: 0.18rem;\n            margin-top: 0.05rem;\n            color: #0A0F1E;\n}\n.write-off-wrapper .content .list .item .right[data-v-1f5d0e0c] {\n          -webkit-box-flex: 1;\n          -webkit-flex: 1;\n             -moz-box-flex: 1;\n              -ms-flex: 1;\n                  flex: 1;\n          -webkit-align-self: center;\n              -ms-flex-item-align: center;\n                      -ms-grid-row-align: center;\n                  align-self: center;\n}\n.write-off-wrapper .content .list .item .right .currency-code[data-v-1f5d0e0c] {\n            font-size: 0.12rem;\n            color: #8C96B4;\n}\n.write-off-wrapper .content .list .item .right .amount[data-v-1f5d0e0c] {\n            font-size: 0.14rem;\n            color: #000000;\n            font-weight: 600;\n}\n.write-off-wrapper .content .list .item .right .write-off-info[data-v-1f5d0e0c] {\n            color: #FA6478;\n            margin-top: 0.04rem;\n}\n.write-off-wrapper .content .list .item .right .write-off-info .currency-code[data-v-1f5d0e0c],\n            .write-off-wrapper .content .list .item .right .write-off-info .amount[data-v-1f5d0e0c] {\n              font-size: 0.12rem;\n              color: #FA6478;\n              font-weight: 400;\n}\n.write-off-wrapper .footer[data-v-1f5d0e0c] {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    z-index: 1;\n    width: 100%;\n    padding: 0.1rem;\n    -webkit-box-sizing: border-box;\n       -moz-box-sizing: border-box;\n            box-sizing: border-box;\n    background: #fff;\n    -webkit-box-shadow: inset 0 1px 0 0 #D7DCE6;\n       -moz-box-shadow: inset 0 1px 0 0 #D7DCE6;\n            box-shadow: inset 0 1px 0 0 #D7DCE6;\n}\n.write-off-wrapper .footer .info[data-v-1f5d0e0c] {\n      color: #636877;\n}\n.write-off-wrapper .footer .info .text[data-v-1f5d0e0c] {\n        font-size: 0.12rem;\n}\n.write-off-wrapper .footer .info .amount[data-v-1f5d0e0c] {\n        font-size: 0.12rem;\n        font-weight: 600;\n}\n.write-off-wrapper .footer .info .currency-code[data-v-1f5d0e0c] {\n        font-size: 0.12rem;\n}\n.write-off-wrapper .footer .btn[data-v-1f5d0e0c] {\n      background: #1E78C8;\n      -webkit-border-radius: 0.05rem;\n         -moz-border-radius: 0.05rem;\n              border-radius: 0.05rem;\n      padding: 0.1rem;\n      margin-top: 0.1rem;\n      font-size: 0.15rem;\n      color: #fff;\n}\n.write-off-wrapper .footer .btn .text[data-v-1f5d0e0c] {\n        line-height: 0.15rem;\n}\n.write-off-wrapper .footer .btn .amount[data-v-1f5d0e0c] {\n        font-weight: 600;\n}\n",""])},879:function(t,e,n){var i=n(845);"string"==typeof i&&(i=[[t.i,i,""]]);n(469)(i,{});i.locals&&(t.exports=i.locals)},974:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition-group",{attrs:{name:t.transName("slide-up")}},[n("loading",{key:"loading",attrs:{"show-loading":t.isShowLoading}}),t._v(" "),t.localLoanList&&t.localLoanList.length?n("section",{key:"content",staticClass:"write-off-wrapper animated"},[t.getProfile["ca.report.expense.compulsory.repayment"]?t._e():n("div",{staticClass:"sub-title half-px-border"},[n("span",{staticClass:"text"},[t._v("\n             "+t._s(t.$t("expense-claim.key50"))+"\n            ")]),t._v(" "),n("span",{staticClass:"submit-btn",on:{click:t.onImmediateSubmited}},[t._v("\n             "+t._s(t.$t("expense-claim.key51"))+"\n            ")])]),t._v(" "),n("div",{staticClass:"content",class:{"has-subtitle":!t.getProfile["ca.report.expense.compulsory.repayment"]}},[n("div",{staticClass:"list"},t._l(t.localLoanList,function(e,i){return n("div",{key:i,staticClass:"item half-px-border",class:{active:null!=t.localSelectedLoanOIDList[e.loanBillOID]},on:{click:function(n){t.onSelected(e)}}},[n("div",{staticClass:"left"},[n("div",{staticClass:"date"},[t._v("\n                            "+t._s(t._f("formatDate")(e.lastModifiedDate))+"\n                        ")]),t._v(" "),n("div",{staticClass:"title  text-ellipsis"},[n("span",[t._v(t._s(e.formName))]),e.title?n("span",[t._v("-"+t._s(e.title))]):t._e()])]),t._v(" "),n("div",{staticClass:"right text-right"},[n("div",{staticClass:"loan-info"},[n("span",{staticClass:"currency-code"},[t._v(t._s(e.currencyCode))]),t._v(" "),n("span",{staticClass:"amount"},[t._v(t._s(t._f("formatMoney")(e.stayWriteOffAmount)))])]),t._v(" "),null!=t.localSelectedLoanOIDList[e.loanBillOID]?n("div",{staticClass:"write-off-info"},[n("span",{staticClass:"sign"},[t._v("-")]),t._v(" "),n("span",{staticClass:"currency-code"},[t._v(t._s(t.baseCurrencyCode))]),t._v(" "),n("span",{staticClass:"amount"},[t._v(t._s(t._f("formatMoney")(t.canRefunAmount)))])]):t._e()])])})),t._v(" "),t.localLoanList&&t.localLoanList.length?t._e():n("empty-content")],1),t._v(" "),n("div",{staticClass:"footer text-center"},[n("div",{staticClass:"info"},[n("span",{staticClass:"text"},[t._v("\n                "+t._s(t.$t("components.key7"))+"\n                ")]),t._v(" "),n("span",{staticClass:"currency-code"},[t._v("\n                    "+t._s(t.baseCurrencyCode)+"\n                ")]),t._v(" "),n("span",{staticClass:"amount"},[t._v(t._s(t._f("formatMoney")(t.paymentAmount)))]),t._v(" "),n("span",{staticClass:"text"},[t._v("— "+t._s(t.$t("expense-claim.key53")))]),t._v(" "),n("span",{staticClass:"currency-code"},[t._v(t._s(t.baseCurrencyCode))]),t._v(" "),n("span",{staticClass:"amount"},[t._v(t._s(t._f("formatMoney")(t.canRefunAmount)))])]),t._v(" "),n("div",{staticClass:"btn",on:{click:t.onRefundSubmited}},[n("span",{staticClass:"text"},[t._v(t._s(t.$t("common.submit"))+"（"+t._s(t.$t("expense-claim.key54")))]),t._v(" "),n("span",{staticClass:"currency-code"},[t._v(t._s(t.baseCurrencyCode))]),t._v(" "),n("span",{staticClass:"amount"},[t._v(" "+t._s(t._f("formatMoney")(t.restAmount)))]),t._v(" "),n("span",{staticClass:"text"},[t._v("）")])])])]):t._e()],1)},staticRenderFns:[]}}});